{"version":3,"sources":["game/assets/sprites/atlas/hero.png","game/assets/sprites/atlas/slime.png","game/assets/sprites/atlas/heart.png","game/assets/sprites/atlas/coin.png","game/assets/sprites/maps/tilesets/tileset.png","game/assets/images/main_menu_background.png","game/assets/images/game_over_background.png","game/assets/images/game_logo.png","game/assets/images/heart_container.png","game/assets/images/sword.png","game/assets/images/push.png","game/assets/sprites/atlas/npc_01.png","game/assets/sprites/atlas/npc_02.png","game/assets/sprites/atlas/npc_03.png","game/assets/sprites/atlas/npc_04.png","game/assets/sprites/atlas/dragon.png","game/scenes/BootScene.js","game/scenes/MainMenuScene.js","game/scenes/GameOverScene.js","game/utils.js","game/constants.js","game/scenes/GameScene.js","game/assets/images/dialog_borderbox.png","game/GameMenu.js","game/Message.js","game/DialogBox.js","game/assets/images/coin.png","game/HeroCoin.js","game/assets/images/health.png","game/HeroHealth.js","App.js","reportWebVitals.js","index.js"],"names":["BootScene","fontSize","progressBar","this","add","graphics","progressBox","cameras","main","gameWidth","width","gameHeight","height","barPositionX","Math","ceil","fillStyle","fillRect","loadingText","text","fontFamily","size","fill","color","setOrigin","setResolution","percentText","assetText","load","on","value","clear","setText","Number","parseInt","file","key","destroy","tilemapTiledJSON","homePageCity","homePageHouse01Map","homePageHouse02Map","homePageHouse03Map","atlas","heroImage","heroJson","slimeImage","slimeJson","heartImage","heartJson","coinImage","coinJson","npc01Image","npc01Json","npc02Image","npc02Json","npc03Image","npc03Json","npc04Image","npc04Json","dragonImage","dragonJson","image","tilesetImage","mainMenuBackgroundImage","gameOverBackgroundImage","gameLogoImage","heartContainerImage","swordImage","pushImage","scene","start","Scene","MainMenuScene","setDepth","scale","max","setScale","customEvent","CustomEvent","detail","menuItems","menuPosition","window","dispatchEvent","addEventListener","gameMenuSelectedEventListener","selectedItem","heroStatus","position","x","y","previousPosition","frame","facingDirection","health","maxHealth","coin","canPush","haveSword","mapKey","location","reload","removeEventListener","createInteractiveGameObject","name","isDebug","origin","customCollider","GameObjects","Rectangle","isCustomCollider","setFillStyle","physics","existing","body","setAllowGravity","setImmovable","SCENE_FADE_TIME","NPC_MOVEMENT_RANDOM","GameScene","enterKey","spaceKey","cursors","wasd","isShowingDialog","isTeleporting","isAttacking","data","initData","currentPosition","gridEngine","getPosition","getFacingDirection","assetKey","animation","anims","generateFrameNames","filter","includes","parts","split","Boolean","isNaN","sort","a","b","animationName","create","frames","replace","frameRate","repeat","yoyo","direction","spriteKey","trim","npcKey","movementType","delay","area","Array","from","length","heroSprite","map","v","index","calculateHeroHealthState","healthStates","heroCoins","enemyType","isDebugMode","config","debug","PhaserMath","Between","itemType","item","sprite","itemsSprites","play","camera","game","sys","initialPosition","initialFrame","heroHealth","heroMaxHealth","heroCoin","heroCanPush","heroHaveSword","fadeIn","input","keyboard","addKey","Input","Keyboard","KeyCodes","ENTER","SPACE","createCursorKeys","addKeys","up","W","down","S","left","A","right","D","make","tilemap","addTilesetImage","phaserGame","updateHeroHealthUi","calculateHeroHealthStates","updateHeroCoinUi","restoreHealth","restore","min","increaseMaxHealth","increase","collectCoin","coinQuantity","takeDamage","damage","time","delayedCall","fadeOut","tweens","targets","alpha","ease","Easing","Elastic","InOut","duration","setSize","setOffset","heroActionCollider","heroPresenceCollider","heroObjectCollider","group","exists","getFramesForAnimation","enemiesData","elementsLayers","i","layer","createLayer","properties","forEach","property","collider","layers","npcsKeys","getObjectLayer","objects","type","overlap","objA","objB","JustDown","characterName","dialogBoxFinishedEventListener","extractNpcDataFromTiled","push","enemyAI","speed","enemySpecies","getEnemySpecies","enemyName","extractTeleportDataFromTiled","teleportToMapKey","teleportToX","teleportToY","overlapCollider","world","removeCollider","restart","calculatePreviousTeleportPosition","some","n","isWalkable","tileX","tileY","every","t","tilemapLayer","getTileAt","ge_collide","centerX","floor","centerY","Clamp","getRandomWalkableTile","startFollow","setFollowOffset","setBounds","widthInPixels","gameSize","heightInPixels","setPosition","gridEngineConfig","characters","id","startPosition","offsetY","find","obj","setVisible","enemiesSprites","enemyData","enemy","setTint","getEnemyColor","updateFollowHeroPosition","lastKnowHeroPosition","isSpaceJustDown","spawnItem","npcSprites","npcData","npc","createPlayerWalkingAnimation","createPlayerAttackAnimation","animationFrame","moveRandomly","isMoving","getEnemyAttackSpeed","canSeeHero","isFollowingHero","heroPosition","heroBackPosition","getBackPosition","enemyPosition","setSpeed","moveTo","NoPathFoundStrategy","embedded","movementStarted","subscribe","charId","getChildren","npcSprite","texture","enemySprite","movementStopped","stop","setFrame","getStopFrame","directionChanged","update","setX","setY","stopMovement","getOppositeDirection","tile","wasHandled","pixelX","pixelY","newPosition","calculatePushTilePosition","getTileAtWorldXY","isMoved","onComplete","newTile","putTileAt","isDown","move","useStyles","makeStyles","theme","menuWrapper","multiplier","textTransform","transform","menuPositionWrapper","innerWidth","menuWidth","minWidth","top","menuItemsWrapper","textAlign","padding","menuItem","cursor","listStyle","marginBottom","backgroundColor","border","selectedMenuItem","GameMenu","items","onSelected","classes","useState","selectedItemIndex","setSelectedItemIndex","useEffect","handleKeyPressed","e","code","className","classNames","onMouseEnter","onClick","dialogMessage","Message","message","trail","onMessageEnded","forceShowFullMessage","useMemo","letter","transitions","useTransition","display","enter","onRest","status","controller","styles","span","style","dialogWindow","messageBoxHeight","imageRendering","borderImage","dialogBorderBox","minHeight","dialogTitle","fontWeight","dialogFooter","bottom","DialogBox","messages","onDone","currentMessage","setCurrentMessage","messageEnded","setMessageEnded","setForceShowFullMessage","handleClick","useCallback","action","coinContainer","userSelect","backgroundSize","background","coinFull","strokeSize","textShadow","HeroCoin","toString","padStart","healthContainer","healthStateFull","healthImage","healthStateHalf","healthStateEmpty","HeroHealth","healthState","innerHeight","calculateGameSize","modal","alignItems","justifyContent","paper","palette","boxShadow","shadows","spacing","overflow","postContainer","maxWidth","maxHeight","gameContentWrapper","margin","pageWrapper","marginTop","marginLeft","preLoadDialogImage","backgroundImage","backgroundRepeat","gameWrapper","gameGif","dialogs","App","setMessages","setCharacterName","gameMenuItems","setGameMenuItems","gameMenuPosition","setGameMenuPosition","heroHealthStates","setHeroHealthStates","setHeroCoins","handleMessageIsDone","handleMenuItemSelected","Phaser","Game","AUTO","title","parent","orientation","Scale","LANDSCAPE","localStorageName","autoRound","pixelArt","autoCenter","CENTER_BOTH","mode","ENVELOP","GameOverScene","default","plugins","plugin","GridEngine","mapping","dialogBoxEventListener","gameMenuEventListener","heroHealthEventListener","heroCoinEventListener","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6752fa65.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/hero.680baedf.png\";","export default __webpack_public_path__ + \"static/media/slime.3a5fd77a.png\";","export default __webpack_public_path__ + \"static/media/heart.277f826b.png\";","export default __webpack_public_path__ + \"static/media/coin.d7185127.png\";","export default __webpack_public_path__ + \"static/media/tileset.bce8ab10.png\";","export default __webpack_public_path__ + \"static/media/main_menu_background.f7d244f3.png\";","export default __webpack_public_path__ + \"static/media/game_over_background.21509171.png\";","export default __webpack_public_path__ + \"static/media/game_logo.68dc69a1.png\";","export default __webpack_public_path__ + \"static/media/heart_container.db75eb15.png\";","export default __webpack_public_path__ + \"static/media/sword.4d0808f2.png\";","export default __webpack_public_path__ + \"static/media/push.0c204cb5.png\";","export default __webpack_public_path__ + \"static/media/npc_01.85943aad.png\";","export default __webpack_public_path__ + \"static/media/npc_02.128762a8.png\";","export default __webpack_public_path__ + \"static/media/npc_03.88a643c6.png\";","export default __webpack_public_path__ + \"static/media/npc_04.ddb002b4.png\";","export default __webpack_public_path__ + \"static/media/dragon.8740548c.png\";","import { Scene } from 'phaser';\r\n\r\n// Houses files\r\nimport homePageHouse01Map from '../assets/sprites/maps/houses/home_page_city_house_01.json';\r\nimport homePageHouse02Map from '../assets/sprites/maps/houses/home_page_city_house_02.json';\r\nimport homePageHouse03Map from '../assets/sprites/maps/houses/home_page_city_house_03.json';\r\n\r\n// Cities files\r\nimport homePageCity from '../assets/sprites/maps/cities/home_page_city.json';\r\n\r\n// Characters files\r\nimport heroJson from '../assets/sprites/atlas/hero.json';\r\nimport slimeJson from '../assets/sprites/atlas/slime.json';\r\nimport heartJson from '../assets/sprites/atlas/heart.json';\r\nimport coinJson from '../assets/sprites/atlas/coin.json';\r\n\r\n// NPC jsons\r\nimport npc01Json from '../assets/sprites/atlas/npc_01.json';\r\nimport npc02Json from '../assets/sprites/atlas/npc_02.json';\r\nimport npc03Json from '../assets/sprites/atlas/npc_03.json';\r\nimport npc04Json from '../assets/sprites/atlas/npc_04.json';\r\nimport dragonJson from '../assets/sprites/atlas/dragon.json';\r\n\r\n// Images\r\nimport heroImage from '../assets/sprites/atlas/hero.png';\r\nimport slimeImage from '../assets/sprites/atlas/slime.png';\r\nimport heartImage from '../assets/sprites/atlas/heart.png';\r\nimport coinImage from '../assets/sprites/atlas/coin.png';\r\nimport tilesetImage from '../assets/sprites/maps/tilesets/tileset.png';\r\nimport mainMenuBackgroundImage from '../assets/images/main_menu_background.png';\r\nimport gameOverBackgroundImage from '../assets/images/game_over_background.png';\r\nimport gameLogoImage from '../assets/images/game_logo.png';\r\nimport heartContainerImage from '../assets/images/heart_container.png';\r\nimport swordImage from '../assets/images/sword.png';\r\nimport pushImage from '../assets/images/push.png';\r\n\r\n// NPC images\r\nimport npc01Image from '../assets/sprites/atlas/npc_01.png';\r\nimport npc02Image from '../assets/sprites/atlas/npc_02.png';\r\nimport npc03Image from '../assets/sprites/atlas/npc_03.png';\r\nimport npc04Image from '../assets/sprites/atlas/npc_04.png';\r\nimport dragonImage from '../assets/sprites/atlas/dragon.png';\r\n\r\nexport default class BootScene extends Scene {\r\n    constructor() {\r\n        super('BootScene');\r\n    }\r\n\r\n    preload() {\r\n        const fontSize = 16;\r\n\r\n        // setup loading bar\r\n        const progressBar = this.add.graphics();\r\n        const progressBox = this.add.graphics();\r\n        const { width: gameWidth, height: gameHeight } = this.cameras.main;\r\n\r\n        const barPositionX = Math.ceil((gameWidth - (gameWidth * 0.7)) / 2);\r\n        progressBox.fillStyle(0x222222, 0.8);\r\n        progressBox.fillRect(\r\n            barPositionX,\r\n            Math.ceil(gameHeight / 6),\r\n            Math.ceil(gameWidth * 0.7),\r\n            Math.ceil(gameHeight / 10)\r\n        );\r\n\r\n        const loadingText = this.add.text(\r\n            gameWidth / 2,\r\n            Math.ceil(gameHeight / 10),\r\n            'loading...',\r\n            {\r\n                fontFamily: '\"Press Start 2P\"',\r\n                fontSize: `${fontSize}px`,\r\n                size: `${fontSize}px`,\r\n                fill: '#ffffff',\r\n                color: '#ffffff',\r\n            }\r\n        );\r\n\r\n        loadingText.setOrigin(0.5);\r\n        loadingText.setResolution(30);\r\n\r\n        const percentText = this.add.text(\r\n            gameWidth / 2,\r\n            Math.ceil((gameHeight / 6) + (fontSize / 2) + (gameHeight / 60)),\r\n            '0%',\r\n            {\r\n                fontFamily: '\"Press Start 2P\"',\r\n                fontSize: `${fontSize}px`,\r\n                size: `${fontSize}px`,\r\n                fill: '#ffffff',\r\n                color: '#ffffff',\r\n            }\r\n        );\r\n\r\n        percentText.setOrigin(0.5);\r\n        percentText.setResolution(30);\r\n\r\n        const assetText = this.add.text(\r\n            gameWidth / 2,\r\n            Math.ceil(gameHeight / 3),\r\n            '',\r\n            {\r\n                fontFamily: '\"Press Start 2P\"',\r\n                fontSize: `${fontSize / 2}px`,\r\n                size: `${fontSize / 2}px`,\r\n                fill: '#ffffff',\r\n                color: '#ffffff',\r\n            }\r\n        );\r\n\r\n        assetText.setOrigin(0.5);\r\n        assetText.setResolution(30);\r\n\r\n        this.load.on('progress', (value) => {\r\n            progressBar.clear();\r\n            progressBar.fillStyle(0xFFFFFF, 1);\r\n            progressBar.fillRect(\r\n                barPositionX,\r\n                Math.ceil(gameHeight / 6),\r\n                Math.ceil(gameWidth * 0.7) * value,\r\n                Math.ceil(gameHeight / 10)\r\n            );\r\n            percentText.setText(`${Number.parseInt(value * 100, 10)}%`);\r\n        });\r\n\r\n        this.load.on('fileprogress', (file) => {\r\n            assetText.setText(`loading: ${file.key}`);\r\n        });\r\n\r\n        this.load.on('complete', () => {\r\n            progressBar.destroy();\r\n            progressBox.destroy();\r\n            percentText.destroy();\r\n            assetText.destroy();\r\n        });\r\n\r\n        // Maps\r\n        this.load.tilemapTiledJSON('home_page_city', homePageCity);\r\n        this.load.tilemapTiledJSON('home_page_city_house_01', homePageHouse01Map);\r\n        this.load.tilemapTiledJSON('home_page_city_house_02', homePageHouse02Map);\r\n        this.load.tilemapTiledJSON('home_page_city_house_03', homePageHouse03Map);\r\n\r\n        // Atlas\r\n        this.load.atlas('hero', heroImage, heroJson);\r\n        this.load.atlas('slime', slimeImage, slimeJson);\r\n        this.load.atlas('heart', heartImage, heartJson);\r\n        this.load.atlas('coin', coinImage, coinJson);\r\n\r\n        // NPCs\r\n        this.load.atlas('npc_01', npc01Image, npc01Json);\r\n        this.load.atlas('npc_02', npc02Image, npc02Json);\r\n        this.load.atlas('npc_03', npc03Image, npc03Json);\r\n        this.load.atlas('npc_04', npc04Image, npc04Json);\r\n        this.load.atlas('dragon', dragonImage, dragonJson)\r\n\r\n        // Tilesets\r\n        this.load.image('tileset', tilesetImage);\r\n\r\n        // Images\r\n        this.load.image('main_menu_background', mainMenuBackgroundImage);\r\n        this.load.image('game_over_background', gameOverBackgroundImage);\r\n        this.load.image('game_logo', gameLogoImage);\r\n        this.load.image('heart_container', heartContainerImage);\r\n        this.load.image('sword', swordImage);\r\n        this.load.image('push', pushImage);\r\n    }\r\n\r\n    create() {\r\n        this.scene.start('MainMenuScene');\r\n    }\r\n}\r\n","import { Scene } from 'phaser';\r\n\r\nexport default class MainMenuScene extends Scene {\r\n    constructor() {\r\n        super('MainMenuScene');\r\n    }\r\n\r\n    preload() {\r\n        // TODO\r\n    }\r\n\r\n    create() {\r\n        const { width: gameWidth, height: gameHeight } = this.cameras.main;\r\n\r\n        this.add.image(gameWidth / 2, Math.ceil(gameHeight / 10), 'game_logo')\r\n            .setOrigin(0.5, 0)\r\n            .setDepth(1);\r\n\r\n        const scale = Math.max(Math.ceil(gameWidth / 480), Math.ceil(gameHeight / 216));\r\n        this.add.image(0, 0, 'main_menu_background')\r\n            .setScale(scale)\r\n            .setDepth(0)\r\n            .setOrigin(0, 0);\r\n\r\n        const customEvent = new CustomEvent('menu-items', {\r\n            detail: {\r\n                menuItems: ['start', 'exit'],\r\n                menuPosition: 'center',\r\n            },\r\n        });\r\n\r\n        window.dispatchEvent(customEvent);\r\n        const gameMenuSelectedEventListener = ({ detail }) => {\r\n            switch (detail.selectedItem) {\r\n                case 'start': {\r\n                    this.scene.start('GameScene', {\r\n                        heroStatus: {\r\n                            position: { x: 4, y: 3 },\r\n                            previousPosition: { x: 4, y: 3 },\r\n                            frame: 'hero_idle_down_01',\r\n                            facingDirection: 'down',\r\n                            health: 60,\r\n                            maxHealth: 60,\r\n                            coin: 0,\r\n                            canPush: false,\r\n                            haveSword: false,\r\n                        },\r\n                        mapKey: 'home_page_city_house_01',\r\n                    });\r\n                    break;\r\n                }\r\n\r\n                case 'exit': {\r\n                    window.location.reload();\r\n                    break;\r\n                }\r\n\r\n                case 'settings': {\r\n                    break;\r\n                }\r\n\r\n                default: {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            window.removeEventListener(\r\n                'menu-item-selected',\r\n                gameMenuSelectedEventListener\r\n            );\r\n        };\r\n\r\n        window.addEventListener(\r\n            'menu-item-selected',\r\n            gameMenuSelectedEventListener\r\n        );\r\n    }\r\n}\r\n","import { Scene } from 'phaser';\r\n\r\nexport default class MainMenuScene extends Scene {\r\n    constructor() {\r\n        super('GameOverScene');\r\n    }\r\n\r\n    preload() {\r\n        // TODO\r\n    }\r\n\r\n    create() {\r\n        // const fontSize = 24;\r\n        const { width: gameWidth, height: gameHeight } = this.cameras.main;\r\n\r\n        // const gameOverText = this.add.text(\r\n        //     gameWidth / 2,\r\n        //     Math.ceil(gameHeight / 5),\r\n        //     'game over',\r\n        //     {\r\n        //         fontFamily: '\"Press Start 2P\"',\r\n        //         fontSize: `${fontSize}px`,\r\n        //         size: `${fontSize}px`,\r\n        //         fill: '#ffffff',\r\n        //         color: '#ffffff',\r\n        //     }\r\n        // ).setDepth(10).setOrigin(0.5, 0.5);\r\n\r\n        const scale = Math.max(Math.ceil(gameWidth / 220), Math.ceil(gameHeight / 124));\r\n        this.add.image(0, 0, 'game_over_background')\r\n            .setScale(scale)\r\n            .setDepth(0)\r\n            .setOrigin(0, 0);\r\n\r\n        const customEvent = new CustomEvent('menu-items', {\r\n            detail: {\r\n                menuItems: ['game.game_over.retry', 'game.game_over.exit'],\r\n                menuPosition: 'center',\r\n            },\r\n        });\r\n\r\n        window.dispatchEvent(customEvent);\r\n        const gameMenuSelectedEventListener = ({ detail }) => {\r\n            switch (detail.selectedItem) {\r\n                case 'game.game_over.retry': {\r\n                    this.scene.start('MainMenuScene');\r\n                    break;\r\n                }\r\n\r\n                case 'game.game_over.exit': {\r\n                    window.location.reload();\r\n                    break;\r\n                }\r\n\r\n                default: {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            window.removeEventListener(\r\n                'menu-item-selected',\r\n                gameMenuSelectedEventListener\r\n            );\r\n        };\r\n\r\n        window.addEventListener(\r\n            'menu-item-selected',\r\n            gameMenuSelectedEventListener\r\n        );\r\n    }\r\n}\r\n","import { GameObjects } from 'phaser';\r\n\r\nexport const createInteractiveGameObject = (\r\n    scene,\r\n    x,\r\n    y,\r\n    width,\r\n    height,\r\n    name,\r\n    isDebug = false,\r\n    origin = { x: 0, y: 1 }\r\n) => {\r\n    const customCollider = new GameObjects.Rectangle(\r\n        scene,\r\n        x,\r\n        y,\r\n        width,\r\n        height\r\n    ).setOrigin(origin.x, origin.y);\r\n    customCollider.name = name;\r\n    customCollider.isCustomCollider = true;\r\n\r\n    if (isDebug) {\r\n        customCollider.setFillStyle(0x741B47);\r\n    }\r\n\r\n    scene.physics.add.existing(customCollider);\r\n    customCollider.body.setAllowGravity(false);\r\n    customCollider.body.setImmovable(true);\r\n\r\n    return customCollider;\r\n};\r\n\r\nexport const calculateGameSize = () => {\r\n    let width = 400;\r\n    let height = 224; // 16 * 14 = 224\r\n    const multiplier = Math.min(Math.floor(window.innerWidth / 400), Math.floor(window.innerHeight / 224)) || 1;\r\n\r\n    if (multiplier > 1) {\r\n        width += Math.floor((window.innerWidth - width * multiplier) / (16 * multiplier)) * 16;\r\n        height += Math.floor((window.innerHeight - height * multiplier) / (16 * multiplier)) * 16;\r\n    }\r\n\r\n    return { width, height, multiplier };\r\n};\r\n","export const SCENE_FADE_TIME = 300;\r\nexport const ATTACK_DELAY_TIME = 50;\r\n\r\n// Tileset stuff\r\nexport const BUSH_INDEX = 428;\r\nexport const BOX_INDEX = 427;\r\nexport const COIN_INDEX = 192;\r\nexport const HEART_CONTAINER_INDEX = 233;\r\n\r\nexport const NPC_MOVEMENT_RANDOM = 'random';\r\nexport const NPC_MOVEMENT_STILL = 'still';\r\n\r\n// Enemies\r\nexport const ENEMY_AI_TYPE = 'follow';\r\n\r\n// Save data\r\nexport const SAVE_DATA_KEY = 'pablogg_game_data';\r\n","import { Input, Math as PhaserMath, Scene } from 'phaser';\r\nimport { createInteractiveGameObject } from '../utils';\r\nimport {\r\n    ATTACK_DELAY_TIME,\r\n    BOX_INDEX,\r\n    BUSH_INDEX,\r\n    ENEMY_AI_TYPE,\r\n    NPC_MOVEMENT_RANDOM,\r\n    SCENE_FADE_TIME,\r\n} from '../constants';\r\n\r\nexport default class GameScene extends Scene {\r\n    constructor() {\r\n        super('GameScene');\r\n    }\r\n\r\n    enterKey = {};\r\n    spaceKey = {};\r\n    cursors = {};\r\n    wasd = {};\r\n    isShowingDialog = false;\r\n    isTeleporting = false;\r\n    isAttacking = false;\r\n\r\n    init(data) {\r\n        this.initData = data;\r\n    }\r\n\r\n    calculatePreviousTeleportPosition() {\r\n        const currentPosition = this.gridEngine.getPosition('hero');\r\n        const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n\r\n        switch (facingDirection) {\r\n            case 'up': {\r\n                return {\r\n                    x: currentPosition.x,\r\n                    y: currentPosition.y + 1,\r\n                };\r\n            }\r\n\r\n            case 'right': {\r\n                return {\r\n                    x: currentPosition.x - 1,\r\n                    y: currentPosition.y,\r\n                };\r\n            }\r\n\r\n            case 'down': {\r\n                return {\r\n                    x: currentPosition.x,\r\n                    y: currentPosition.y - 1,\r\n                };\r\n            }\r\n\r\n            case 'left': {\r\n                return {\r\n                    x: currentPosition.x + 1,\r\n                    y: currentPosition.y,\r\n                };\r\n            }\r\n\r\n            default: {\r\n                return {\r\n                    x: currentPosition.x,\r\n                    y: currentPosition.y,\r\n                };\r\n            }\r\n        }\r\n    }\r\n\r\n    getFramesForAnimation(assetKey, animation) {\r\n        return this.anims.generateFrameNames(assetKey)\r\n            .filter((frame) => {\r\n                if (frame.frame.includes(`${assetKey}_${animation}`)) {\r\n                    const parts = frame.frame.split(`${assetKey}_${animation}_`);\r\n                    return Boolean(!Number.isNaN(Number.parseInt(parts[1], 10)));\r\n                }\r\n\r\n                return false;\r\n            })\r\n            .sort((a, b) => (a.frame < b.frame ? -1 : 1));\r\n    }\r\n\r\n    createPlayerWalkingAnimation(assetKey, animationName) {\r\n        this.anims.create({\r\n            key: `${assetKey}_${animationName}`,\r\n            frames: [\r\n                { key: assetKey, frame: `${assetKey}_${animationName}_01` },\r\n                { key: assetKey, frame: `${assetKey}_${animationName.replace('walking', 'idle')}_01` },\r\n                { key: assetKey, frame: `${assetKey}_${animationName}_02` },\r\n            ],\r\n            frameRate: 4,\r\n            repeat: -1,\r\n            yoyo: true,\r\n        });\r\n    }\r\n\r\n    createPlayerAttackAnimation(assetKey, animationName) {\r\n        this.anims.create({\r\n            key: `${assetKey}_${animationName}`,\r\n            frames: [\r\n                { key: assetKey, frame: `${assetKey}_${animationName}_01` },\r\n                { key: assetKey, frame: `${assetKey}_${animationName}_02` },\r\n                { key: assetKey, frame: `${assetKey}_${animationName}_03` },\r\n                { key: assetKey, frame: `${assetKey}_${animationName}_04` },\r\n                { key: assetKey, frame: `${assetKey}_${animationName.replace('attack', 'idle')}_01` },\r\n            ],\r\n            frameRate: 16,\r\n            repeat: 0,\r\n            yoyo: false,\r\n        });\r\n    }\r\n\r\n    getStopFrame(direction, spriteKey) {\r\n        switch (direction) {\r\n            case 'up':\r\n                return `${spriteKey}_idle_up_01`;\r\n            case 'right':\r\n                return `${spriteKey}_idle_right_01`;\r\n            case 'down':\r\n                return `${spriteKey}_idle_down_01`;\r\n            case 'left':\r\n                return `${spriteKey}_idle_left_01`;\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n    getOppositeDirection(direction) {\r\n        switch (direction) {\r\n            case 'up':\r\n                return 'down';\r\n            case 'right':\r\n                return 'left';\r\n            case 'down':\r\n                return 'up';\r\n            case 'left':\r\n                return 'right';\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n    getBackPosition(facingDirection, position) {\r\n        switch (facingDirection) {\r\n            case 'up':\r\n                return {\r\n                    ...position,\r\n                    y: position.y + 1,\r\n                };\r\n            case 'right':\r\n                return {\r\n                    ...position,\r\n                    x: position.x - 1,\r\n                };\r\n            case 'down':\r\n                return {\r\n                    ...position,\r\n                    y: position.y - 1,\r\n                };\r\n            case 'left':\r\n                return {\r\n                    ...position,\r\n                    x: position.x + 1,\r\n                };\r\n            default:\r\n                return position;\r\n        }\r\n    }\r\n\r\n    extractTeleportDataFromTiled(data) {\r\n        const [mapKey, position] = data.trim().split(':');\r\n        const [x, y] = position.split(',');\r\n\r\n        return {\r\n            mapKey,\r\n            x: Number.parseInt(x, 10),\r\n            y: Number.parseInt(y, 10),\r\n        };\r\n    }\r\n\r\n    extractNpcDataFromTiled(data) {\r\n        const [npcKey, config] = data.trim().split(':');\r\n        const [movementType, delay, area, direction] = config.split(';');\r\n\r\n        return {\r\n            npcKey,\r\n            movementType,\r\n            facingDirection: direction,\r\n            delay: Number.parseInt(delay, 10),\r\n            area: Number.parseInt(area, 10),\r\n        };\r\n    }\r\n\r\n    calculateHeroHealthState(health) {\r\n        if (health > 10) {\r\n            return 'full';\r\n        }\r\n\r\n        if (health > 0) {\r\n            return 'half';\r\n        }\r\n\r\n        return 'empty';\r\n    }\r\n\r\n    calculateHeroHealthStates() {\r\n        return Array.from({ length: this.heroSprite.maxHealth / 20 })\r\n            .fill(null).map(\r\n                (v, index) => this.calculateHeroHealthState(\r\n                    Math.max(this.heroSprite.health - (20 * index), 0)\r\n                )\r\n            );\r\n    }\r\n\r\n    updateHeroHealthUi(healthStates) {\r\n        const customEvent = new CustomEvent('hero-health', {\r\n            detail: {\r\n                healthStates,\r\n            },\r\n        });\r\n\r\n        window.dispatchEvent(customEvent);\r\n    }\r\n\r\n    updateHeroCoinUi(heroCoins) {\r\n        const customEvent = new CustomEvent('hero-coin', {\r\n            detail: {\r\n                heroCoins,\r\n            },\r\n        });\r\n\r\n        window.dispatchEvent(customEvent);\r\n    }\r\n\r\n    getEnemySpecies(enemyType) {\r\n        if (enemyType.includes('slime')) {\r\n            return 'slime';\r\n        }\r\n\r\n        return 'slime';\r\n    }\r\n\r\n    getEnemyColor(enemyType) {\r\n        if (enemyType.includes('red')) {\r\n            return 0xF1374B;\r\n        }\r\n\r\n        if (enemyType.includes('green')) {\r\n            return 0x2BBD6E;\r\n        }\r\n\r\n        if (enemyType.includes('yellow')) {\r\n            return 0xFFFF4F;\r\n        }\r\n\r\n        return 0x00A0DC;\r\n    }\r\n\r\n    getEnemyAttackSpeed(enemyType) {\r\n        if (enemyType.includes('red')) {\r\n            return 2000;\r\n        }\r\n\r\n        if (enemyType.includes('green')) {\r\n            return 3000;\r\n        }\r\n\r\n        if (enemyType.includes('yellow')) {\r\n            return 4000;\r\n        }\r\n\r\n        return 5000;\r\n    }\r\n\r\n    spawnItem(position) {\r\n        const isDebugMode = this.physics.config.debug;\r\n        const itemChance = PhaserMath.Between(1, isDebugMode ? 2 : 5);\r\n        if (itemChance === 1) {\r\n            const itemType = PhaserMath.Between(1, 2);\r\n\r\n            if (itemType === 1) {\r\n                const item = this.physics.add\r\n                    .sprite(position.x, position.y, 'heart')\r\n                    .setDepth(1)\r\n                    .setOrigin(0, 0);\r\n                item.itemType = 'heart';\r\n                this.itemsSprites.add(item);\r\n                item.anims.play('heart_idle');\r\n            } else if (itemType === 2) {\r\n                const item = this.physics.add\r\n                    .sprite(position.x, position.y, 'coin')\r\n                    .setDepth(1)\r\n                    .setOrigin(0, 0);\r\n                item.itemType = 'coin';\r\n                this.itemsSprites.add(item);\r\n                item.anims.play('coin_idle');\r\n            }\r\n        }\r\n    }\r\n\r\n    calculatePushTilePosition() {\r\n        const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n        const position = this.gridEngine.getPosition('hero');\r\n\r\n        switch (facingDirection) {\r\n            case 'up':\r\n                return {\r\n                    x: position.x * 16,\r\n                    y: (position.y - 2) * 16,\r\n                };\r\n\r\n            case 'right':\r\n                return {\r\n                    x: (position.x + 2) * 16,\r\n                    y: position.y * 16,\r\n                };\r\n\r\n            case 'down':\r\n                return {\r\n                    x: position.x * 16,\r\n                    y: (position.y + 2) * 16,\r\n                };\r\n\r\n            case 'left':\r\n                return {\r\n                    x: (position.x - 2) * 16,\r\n                    y: position.y * 16,\r\n                };\r\n\r\n            default:\r\n                return {\r\n                    x: position.x * 16,\r\n                    y: position.y * 16,\r\n                };\r\n        }\r\n    }\r\n\r\n    create() {\r\n        const camera = this.cameras.main;\r\n        const { game } = this.sys;\r\n        const isDebugMode = this.physics.config.debug;\r\n        const { heroStatus, mapKey } = this.initData;\r\n        const {\r\n            position: initialPosition,\r\n            frame: initialFrame,\r\n            facingDirection: initialFacingDirection,\r\n            previousPosition,\r\n            health: heroHealth,\r\n            maxHealth: heroMaxHealth,\r\n            coin: heroCoin,\r\n            canPush: heroCanPush,\r\n            haveSword: heroHaveSword,\r\n        } = heroStatus;\r\n\r\n        camera.fadeIn(SCENE_FADE_TIME);\r\n\r\n        this.enterKey = this.input.keyboard.addKey(Input.Keyboard.KeyCodes.ENTER);\r\n        this.spaceKey = this.input.keyboard.addKey(Input.Keyboard.KeyCodes.SPACE);\r\n        this.cursors = this.input.keyboard.createCursorKeys();\r\n        this.wasd = this.input.keyboard.addKeys({\r\n            up: Input.Keyboard.KeyCodes.W,\r\n            down: Input.Keyboard.KeyCodes.S,\r\n            left: Input.Keyboard.KeyCodes.A,\r\n            right: Input.Keyboard.KeyCodes.D,\r\n        });\r\n\r\n        // Map\r\n        const map = this.make.tilemap({ key: mapKey });\r\n        map.addTilesetImage('tileset', 'tileset');\r\n\r\n        if (isDebugMode) {\r\n            window.phaserGame = game;\r\n            this.map = map;\r\n        }\r\n\r\n        // Hero\r\n        this.heroSprite = this.physics.add\r\n            .sprite(0, 0, 'hero', initialFrame)\r\n            .setDepth(1);\r\n        this.heroSprite.health = heroHealth;\r\n        this.heroSprite.maxHealth = heroMaxHealth;\r\n        this.heroSprite.coin = heroCoin;\r\n        this.heroSprite.canPush = heroCanPush;\r\n        this.heroSprite.haveSword = heroHaveSword;\r\n        this.updateHeroHealthUi(this.calculateHeroHealthStates());\r\n        this.updateHeroCoinUi(heroCoin);\r\n\r\n        this.heroSprite.restoreHealth = (restore) => {\r\n            this.heroSprite.health = Math.min(this.heroSprite.health + restore, this.heroSprite.maxHealth);\r\n            this.updateHeroHealthUi(this.calculateHeroHealthStates());\r\n        };\r\n\r\n        this.heroSprite.increaseMaxHealth = (increase) => {\r\n            this.heroSprite.maxHealth += increase;\r\n            this.updateHeroHealthUi(this.calculateHeroHealthStates());\r\n        };\r\n\r\n        this.heroSprite.collectCoin = (coinQuantity) => {\r\n            this.heroSprite.coin = Math.min(this.heroSprite.coin + coinQuantity, 999);\r\n            this.updateHeroCoinUi(this.heroSprite.coin);\r\n        };\r\n\r\n        this.heroSprite.takeDamage = (damage) => {\r\n            this.time.delayedCall(\r\n                180,\r\n                () => {\r\n                    this.heroSprite.health -= damage;\r\n                    if (this.heroSprite.health <= 0) {\r\n                        camera.fadeOut(SCENE_FADE_TIME);\r\n                        this.updateHeroHealthUi([]);\r\n                        this.updateHeroCoinUi(null);\r\n                        this.time.delayedCall(\r\n                            SCENE_FADE_TIME,\r\n                            () => {\r\n                                this.isTeleporting = false;\r\n                                this.scene.start('GameOverScene');\r\n                            }\r\n                        );\r\n                    } else {\r\n                        this.updateHeroHealthUi(this.calculateHeroHealthStates());\r\n                        this.tweens.add({\r\n                            targets: this.heroSprite,\r\n                            alpha: 0,\r\n                            ease: PhaserMath.Easing.Elastic.InOut,\r\n                            duration: 70,\r\n                            repeat: 1,\r\n                            yoyo: true,\r\n                        });\r\n                    }\r\n                }\r\n            );\r\n        };\r\n        this.heroSprite.body.setSize(14, 14);\r\n        this.heroSprite.body.setOffset(9, 13);\r\n        this.heroActionCollider = createInteractiveGameObject(\r\n            this,\r\n            this.heroSprite.x + 9,\r\n            this.heroSprite.y + 36,\r\n            14,\r\n            8,\r\n            'attack',\r\n            isDebugMode\r\n        );\r\n        this.heroPresenceCollider = createInteractiveGameObject(\r\n            this,\r\n            this.heroSprite.x + 16,\r\n            this.heroSprite.y + 20,\r\n            320, // TODO\r\n            320, // TODO\r\n            'presence',\r\n            isDebugMode,\r\n            { x: 0.5, y: 0.5 }\r\n        );\r\n        this.heroObjectCollider = createInteractiveGameObject(\r\n            this,\r\n            this.heroSprite.x + 16,\r\n            this.heroSprite.y + 20,\r\n            24,\r\n            24,\r\n            'object',\r\n            isDebugMode,\r\n            { x: 0.5, y: 0.5 }\r\n        );\r\n\r\n        // Items\r\n        this.itemsSprites = this.add.group();\r\n        if (!this.anims.exists('heart_idle')) {\r\n            this.anims.create({\r\n                key: 'heart_idle',\r\n                frames: this.getFramesForAnimation('heart', 'idle'),\r\n                frameRate: 4,\r\n                repeat: -1,\r\n                yoyo: false,\r\n            });\r\n        }\r\n\r\n        if (!this.anims.exists('coin_idle')) {\r\n            this.anims.create({\r\n                key: 'coin_idle',\r\n                frames: this.getFramesForAnimation('coin', 'idle'),\r\n                frameRate: 4,\r\n                repeat: -1,\r\n                yoyo: false,\r\n            });\r\n        }\r\n\r\n        const enemiesData = [];\r\n        const elementsLayers = this.add.group();\r\n        for (let i = 0; i < map.layers.length; i++) {\r\n            const layer = map.createLayer(i, 'tileset', 0, 0);\r\n            layer.layer.properties.forEach((property) => {\r\n                const { value, name } = property;\r\n\r\n                if (name === 'type' && value === 'elements') {\r\n                    elementsLayers.add(layer);\r\n                }\r\n            });\r\n\r\n            this.physics.add.collider(this.heroSprite, layer);\r\n        }\r\n\r\n        const npcsKeys = [];\r\n        const dataLayer = map.getObjectLayer('actions');\r\n        dataLayer.objects.forEach((data) => {\r\n            const { properties, x, y } = data;\r\n\r\n            properties.forEach((property) => {\r\n                const { name, type, value } = property;\r\n\r\n                switch (name) {\r\n                    case 'dialog': {\r\n                        const customCollider = createInteractiveGameObject(\r\n                            this,\r\n                            x,\r\n                            y,\r\n                            16,\r\n                            16,\r\n                            'dialog',\r\n                            isDebugMode\r\n                        );\r\n\r\n                        this.physics.add.overlap(this.heroActionCollider, customCollider, (objA, objB) => {\r\n                            if (this.isShowingDialog) {\r\n                                return;\r\n                            }\r\n\r\n                            if (Input.Keyboard.JustDown(this.enterKey)) {\r\n                                const characterName = value;\r\n                                const customEvent = new CustomEvent('new-dialog', {\r\n                                    detail: {\r\n                                        characterName,\r\n                                    },\r\n                                });\r\n\r\n                                window.dispatchEvent(customEvent);\r\n                                const dialogBoxFinishedEventListener = () => {\r\n                                    window.removeEventListener(\r\n                                        `${characterName}-dialog-finished`,\r\n                                        dialogBoxFinishedEventListener\r\n                                    );\r\n\r\n                                    // just to consume the JustDown\r\n                                    Input.Keyboard.JustDown(this.enterKey);\r\n                                    Input.Keyboard.JustDown(this.spaceKey);\r\n\r\n                                    this.time.delayedCall(100, () => {\r\n                                        this.isShowingDialog = false;\r\n                                    });\r\n                                };\r\n                                window.addEventListener(\r\n                                    `${characterName}-dialog-finished`,\r\n                                    dialogBoxFinishedEventListener\r\n                                );\r\n\r\n                                this.isShowingDialog = true;\r\n                            }\r\n                        });\r\n\r\n                        break;\r\n                    }\r\n\r\n                    case 'npcData': {\r\n                        const {\r\n                            facingDirection,\r\n                            movementType,\r\n                            npcKey,\r\n                            delay,\r\n                            area,\r\n                        } = this.extractNpcDataFromTiled(value);\r\n\r\n                        npcsKeys.push({\r\n                            facingDirection,\r\n                            movementType,\r\n                            npcKey,\r\n                            delay,\r\n                            area,\r\n                            x,\r\n                            y,\r\n                        });\r\n                        break;\r\n                    }\r\n\r\n                    case 'itemData': {\r\n                        const [itemType] = value.split(':');\r\n\r\n                        switch (itemType) {\r\n                            case 'coin': {\r\n                                const item = this.physics.add\r\n                                    .sprite(x, y, 'coin')\r\n                                    .setDepth(1)\r\n                                    .setOrigin(0, 1);\r\n\r\n                                item.itemType = 'coin';\r\n                                this.itemsSprites.add(item);\r\n                                item.anims.play('coin_idle');\r\n                                break;\r\n                            }\r\n\r\n                            case 'heart_container': {\r\n                                const item = this.physics.add\r\n                                    .sprite(x, y, 'heart_container')\r\n                                    .setDepth(1)\r\n                                    .setOrigin(0, 1);\r\n\r\n                                item.itemType = 'heart_container';\r\n                                this.itemsSprites.add(item);\r\n                                break;\r\n                            }\r\n\r\n                            case 'heart': {\r\n                                const item = this.physics.add\r\n                                    .sprite(x, y, 'heart')\r\n                                    .setDepth(1)\r\n                                    .setOrigin(0, 1);\r\n\r\n                                item.itemType = 'heart';\r\n                                this.itemsSprites.add(item);\r\n                                item.anims.play('heart_idle');\r\n                                break;\r\n                            }\r\n\r\n                            case 'sword': {\r\n                                if (!heroHaveSword) {\r\n                                    const item = this.physics.add\r\n                                        .sprite(x, y, 'sword')\r\n                                        .setDepth(1)\r\n                                        .setOrigin(0, 1);\r\n\r\n                                    item.itemType = 'sword';\r\n                                    this.itemsSprites.add(item);\r\n                                }\r\n\r\n                                break;\r\n                            }\r\n\r\n                            case 'push': {\r\n                                if (!heroCanPush) {\r\n                                    const item = this.physics.add\r\n                                        .sprite(x, y, 'push')\r\n                                        .setDepth(1)\r\n                                        .setOrigin(0, 1);\r\n\r\n                                    item.itemType = 'push';\r\n                                    this.itemsSprites.add(item);\r\n                                }\r\n\r\n                                break;\r\n                            }\r\n\r\n                            default: {\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        break;\r\n                    }\r\n\r\n                    case 'enemyData': {\r\n                        const [enemyType, enemyAI, speed, health] = value.split(':');\r\n                        enemiesData.push({\r\n                            x,\r\n                            y,\r\n                            speed: Number.parseInt(speed, 10),\r\n                            enemyType,\r\n                            enemySpecies: this.getEnemySpecies(enemyType),\r\n                            enemyAI,\r\n                            enemyName: `${enemyType}_${enemiesData.length}`,\r\n                            health: Number.parseInt(health, 10),\r\n                        });\r\n                        break;\r\n                    }\r\n\r\n                    case 'teleportTo': {\r\n                        const customCollider = createInteractiveGameObject(\r\n                            this,\r\n                            x,\r\n                            y,\r\n                            16,\r\n                            16,\r\n                            'teleport',\r\n                            isDebugMode\r\n                        );\r\n\r\n                        const {\r\n                            mapKey: teleportToMapKey,\r\n                            x: teleportToX,\r\n                            y: teleportToY,\r\n                        } = this.extractTeleportDataFromTiled(value);\r\n\r\n                        const overlapCollider = this.physics.add.overlap(this.heroSprite, customCollider, () => {\r\n                            // camera.stopFollow();\r\n                            this.physics.world.removeCollider(overlapCollider);\r\n                            const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n                            camera.fadeOut(SCENE_FADE_TIME);\r\n                            // this.scene.pause();\r\n                            this.isTeleporting = true;\r\n                            // this.gridEngine.stopMovement('hero');\r\n\r\n                            this.time.delayedCall(\r\n                                SCENE_FADE_TIME,\r\n                                () => {\r\n                                    this.isTeleporting = false;\r\n                                    this.scene.restart({\r\n                                        heroStatus: {\r\n                                            position: { x: teleportToX, y: teleportToY },\r\n                                            previousPosition: this.calculatePreviousTeleportPosition(),\r\n                                            frame: `hero_idle_${facingDirection}_01`,\r\n                                            facingDirection,\r\n                                            health: this.heroSprite.health,\r\n                                            maxHealth: this.heroSprite.maxHealth,\r\n                                            coin: this.heroSprite.coin,\r\n                                            canPush: this.heroSprite.canPush,\r\n                                            haveSword: this.heroSprite.haveSword,\r\n                                        },\r\n                                        mapKey: teleportToMapKey,\r\n                                    });\r\n                                }\r\n                            );\r\n                        });\r\n\r\n                        break;\r\n                    }\r\n\r\n                    default: {\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        // If we're in the city and no dragon NPC was placed in Tiled, spawn one at a random walkable spot\r\n        if (mapKey === 'home_page_city' && !npcsKeys.some((n) => n.npcKey === 'dragon')) {\r\n            const isWalkable = (tileX, tileY) => {\r\n                // A tile is walkable if none of the layers has a collidable tile at that location\r\n                return map.layers.every((layer) => {\r\n                    const t = layer.tilemapLayer.getTileAt(tileX, tileY);\r\n                    return !(t?.properties?.ge_collide);\r\n                });\r\n            };\r\n\r\n            const getRandomWalkableTile = () => {\r\n                const centerX = Math.floor(map.width / 2);\r\n                const centerY = Math.floor(map.height / 2);\r\n\r\n                // Try near center first\r\n                const maxAttemptsNearCenter = 400;\r\n                const radius = 8; // tiles\r\n                for (let i = 0; i < maxAttemptsNearCenter; i++) {\r\n                    const tileX = PhaserMath.Clamp(\r\n                        centerX + PhaserMath.Between(-radius, radius),\r\n                        1,\r\n                        map.width - 2\r\n                    );\r\n                    const tileY = PhaserMath.Clamp(\r\n                        centerY + PhaserMath.Between(-radius, radius),\r\n                        1,\r\n                        map.height - 2\r\n                    );\r\n                    if (isWalkable(tileX, tileY)) {\r\n                        return { tileX, tileY };\r\n                    }\r\n                }\r\n\r\n                // Fallback anywhere on map\r\n                const maxAttempts = 500;\r\n                for (let i = 0; i < maxAttempts; i++) {\r\n                    const tileX = PhaserMath.Between(1, map.width - 2);\r\n                    const tileY = PhaserMath.Between(1, map.height - 2);\r\n                    if (isWalkable(tileX, tileY)) {\r\n                        return { tileX, tileY };\r\n                    }\r\n                }\r\n                // Final fallback\r\n                return { tileX: centerX, tileY: centerY };\r\n            };\r\n\r\n            const { tileX, tileY } = getRandomWalkableTile();\r\n            // Convert to pixel coordinates matching Tiled object placement used elsewhere (note the +1 on y)\r\n            npcsKeys.push({\r\n                npcKey: 'dragon',\r\n                movementType: NPC_MOVEMENT_RANDOM,\r\n                delay: 1000,\r\n                area: 4,\r\n                facingDirection: 'down',\r\n                x: tileX * 16,\r\n                y: (tileY + 1) * 16,\r\n            });\r\n        }\r\n\r\n        camera.startFollow(this.heroSprite, true);\r\n        camera.setFollowOffset(-this.heroSprite.width, -this.heroSprite.height);\r\n        camera.setBounds(\r\n            0,\r\n            0,\r\n            Math.max(map.widthInPixels, game.scale.gameSize.width),\r\n            Math.max(map.heightInPixels, game.scale.gameSize.height)\r\n        );\r\n\r\n        if (map.widthInPixels < game.scale.gameSize.width) {\r\n            camera.setPosition(\r\n                (game.scale.gameSize.width - map.widthInPixels) / 2\r\n            );\r\n        }\r\n\r\n        if (map.heightInPixels < game.scale.gameSize.height) {\r\n            camera.setPosition(\r\n                camera.x,\r\n                (game.scale.gameSize.height - map.heightInPixels) / 2\r\n            );\r\n        }\r\n\r\n        const gridEngineConfig = {\r\n            characters: [\r\n                {\r\n                    id: 'hero',\r\n                    sprite: this.heroSprite,\r\n                    startPosition: initialPosition,\r\n                    offsetY: 4,\r\n                },\r\n            ],\r\n        };\r\n\r\n        this.physics.add.overlap(this.heroSprite, this.itemsSprites, (objA, objB) => {\r\n            const item = [objA, objB].find((obj) => obj !== this.heroSprite);\r\n\r\n            if (item.itemType === 'heart') {\r\n                this.heroSprite.restoreHealth(20);\r\n                item.setVisible(false);\r\n                item.destroy();\r\n            }\r\n\r\n            if (item.itemType === 'coin') {\r\n                this.heroSprite.collectCoin(1);\r\n                item.setVisible(false);\r\n                item.destroy();\r\n            }\r\n\r\n            if (item.itemType === 'heart_container') {\r\n                this.heroSprite.increaseMaxHealth(20);\r\n                item.setVisible(false);\r\n                item.destroy();\r\n            }\r\n\r\n            if (item.itemType === 'sword') {\r\n                const customEvent = new CustomEvent('new-dialog', {\r\n                    detail: {\r\n                        characterName: item.itemType,\r\n                    },\r\n                });\r\n                window.dispatchEvent(customEvent);\r\n                this.isShowingDialog = true;\r\n                const dialogBoxFinishedEventListener = () => {\r\n                    window.removeEventListener(\r\n                        `${item.itemType}-dialog-finished`,\r\n                        dialogBoxFinishedEventListener\r\n                    );\r\n\r\n                    this.time.delayedCall(100, () => {\r\n                        this.isShowingDialog = false;\r\n                    });\r\n                };\r\n                window.addEventListener(\r\n                    `${item.itemType}-dialog-finished`,\r\n                    dialogBoxFinishedEventListener\r\n                );\r\n\r\n                this.heroSprite.haveSword = true;\r\n                item.setVisible(false);\r\n                item.destroy();\r\n            }\r\n\r\n            if (item.itemType === 'push') {\r\n                const customEvent = new CustomEvent('new-dialog', {\r\n                    detail: {\r\n                        characterName: item.itemType,\r\n                    },\r\n                });\r\n                window.dispatchEvent(customEvent);\r\n                this.isShowingDialog = true;\r\n                const dialogBoxFinishedEventListener = () => {\r\n                    window.removeEventListener(\r\n                        `${item.itemType}-dialog-finished`,\r\n                        dialogBoxFinishedEventListener\r\n                    );\r\n\r\n                    this.time.delayedCall(100, () => {\r\n                        this.isShowingDialog = false;\r\n                    });\r\n                };\r\n                window.addEventListener(\r\n                    `${item.itemType}-dialog-finished`,\r\n                    dialogBoxFinishedEventListener\r\n                );\r\n\r\n                this.heroSprite.canPush = true;\r\n                item.setVisible(false);\r\n                item.destroy();\r\n            }\r\n        });\r\n\r\n        this.enemiesSprites = this.add.group();\r\n        enemiesData.forEach((enemyData, index) => {\r\n            const { enemySpecies, enemyType, x, y, enemyName, speed, enemyAI, health } = enemyData;\r\n            const enemy = this.physics.add.sprite(0, 0, enemyType, `${enemySpecies}_idle_01`);\r\n            enemy.setTint(this.getEnemyColor(enemyType));\r\n            enemy.name = enemyName;\r\n            enemy.enemyType = enemyType;\r\n            enemy.enemySpecies = enemySpecies;\r\n            enemy.enemyAI = enemyAI;\r\n            enemy.speed = speed;\r\n            enemy.health = health;\r\n            enemy.isAttacking = false;\r\n            enemy.updateFollowHeroPosition = true;\r\n            enemy.lastKnowHeroPosition = { x: 0, y: 0 };\r\n            enemy.body.setSize(14, 14);\r\n            enemy.body.setOffset(9, 21);\r\n            this.enemiesSprites.add(enemy);\r\n            enemy.takeDamage = (damage, isSpaceJustDown) => {\r\n                if (isSpaceJustDown) {\r\n                    enemy.health -= damage;\r\n\r\n                    if (enemy.health < 0) {\r\n                        enemy.setVisible(false);\r\n                        const position = this.gridEngine.getPosition(enemy.name);\r\n                        this.spawnItem({\r\n                            x: position.x * 16,\r\n                            y: position.y * 16,\r\n                        });\r\n                        this.gridEngine.setPosition(enemy.name, { x: 1, y: 1 });\r\n                        enemy.destroy();\r\n                    } else {\r\n                        this.tweens.add({\r\n                            targets: enemy,\r\n                            alpha: 0,\r\n                            ease: PhaserMath.Easing.Elastic.InOut,\r\n                            duration: 70,\r\n                            repeat: 1,\r\n                            yoyo: true,\r\n                        });\r\n                    }\r\n                }\r\n            };\r\n\r\n            if (!this.anims.exists(`${enemySpecies}_idle`)) {\r\n                this.anims.create({\r\n                    key: `${enemySpecies}_idle`,\r\n                    frames: this.getFramesForAnimation(enemySpecies, 'idle'),\r\n                    frameRate: 8,\r\n                    repeat: -1,\r\n                    yoyo: false,\r\n                });\r\n            }\r\n\r\n            if (!this.anims.exists(`${enemySpecies}_attack`)) {\r\n                this.anims.create({\r\n                    key: `${enemySpecies}_attack`,\r\n                    frames: this.getFramesForAnimation(enemySpecies, 'attack'),\r\n                    frameRate: 12,\r\n                    repeat: 0,\r\n                    yoyo: false,\r\n                });\r\n            }\r\n\r\n            if (!this.anims.exists(`${enemySpecies}_walking`)) {\r\n                this.anims.create({\r\n                    key: `${enemySpecies}_walking`,\r\n                    frames: this.getFramesForAnimation(enemySpecies, 'walking'),\r\n                    frameRate: 8,\r\n                    repeat: -1,\r\n                    yoyo: false,\r\n                });\r\n            }\r\n\r\n            if (!this.anims.exists(`${enemySpecies}_die`)) {\r\n                this.anims.create({\r\n                    key: `${enemySpecies}_die`,\r\n                    frames: this.getFramesForAnimation(enemySpecies, 'die'),\r\n                    frameRate: 8,\r\n                    repeat: 0,\r\n                    yoyo: false,\r\n                });\r\n            }\r\n\r\n            enemy.anims.play(`${enemySpecies}_idle`);\r\n            enemy.on('animationcomplete', (animation) => {\r\n                if (animation.key.includes('attack')) {\r\n                    enemy.anims.play(`${enemySpecies}_idle`);\r\n                }\r\n            });\r\n\r\n            gridEngineConfig.characters.push({\r\n                id: enemyName,\r\n                sprite: enemy,\r\n                startPosition: { x: x / 16, y: (y / 16) - 1 },\r\n                speed,\r\n                offsetY: -4,\r\n            });\r\n        });\r\n\r\n        const npcSprites = this.add.group();\r\n        npcsKeys.forEach((npcData) => {\r\n            const { npcKey, x, y, facingDirection = 'down' } = npcData;\r\n            const initialFrame = `${npcKey}_idle_${facingDirection}_01`;\r\n            const npc = this.physics.add.sprite(0, 0, npcKey, initialFrame);\r\n            npc.body.setSize(14, 14);\r\n            npc.body.setOffset(9, 13);\r\n            npcSprites.add(npc);\r\n\r\n            this.createPlayerWalkingAnimation(npcKey, 'walking_up');\r\n            this.createPlayerWalkingAnimation(npcKey, 'walking_right');\r\n            this.createPlayerWalkingAnimation(npcKey, 'walking_down');\r\n            this.createPlayerWalkingAnimation(npcKey, 'walking_left');\r\n\r\n            gridEngineConfig.characters.push({\r\n                id: npcKey,\r\n                sprite: npc,\r\n                startPosition: { x: x / 16, y: (y / 16) - 1 },\r\n                speed: 1,\r\n                offsetY: 4,\r\n            });\r\n        });\r\n\r\n        // Movement\r\n        this.createPlayerWalkingAnimation('hero', 'walking_up');\r\n        this.createPlayerWalkingAnimation('hero', 'walking_right');\r\n        this.createPlayerWalkingAnimation('hero', 'walking_down');\r\n        this.createPlayerWalkingAnimation('hero', 'walking_left');\r\n\r\n        // Attack\r\n        this.createPlayerAttackAnimation('hero', 'attack_up', 12, 0, false);\r\n        this.createPlayerAttackAnimation('hero', 'attack_right', 12, 0, false);\r\n        this.createPlayerAttackAnimation('hero', 'attack_down', 12, 0, false);\r\n        this.createPlayerAttackAnimation('hero', 'attack_left', 12, 0, false);\r\n\r\n        this.heroSprite.on('animationcomplete', (animation, animationFrame) => {\r\n            if (animation.key.includes('attack')) {\r\n                this.isAttacking = false;\r\n            }\r\n        });\r\n\r\n        this.heroSprite.on('animationstop', (animation, animationFrame) => {\r\n            if (animation.key.includes('attack')) {\r\n                this.isAttacking = false;\r\n            }\r\n        });\r\n\r\n        this.gridEngine.create(map, gridEngineConfig);\r\n\r\n        // NPCs\r\n        npcsKeys.forEach((npcData) => {\r\n            const {\r\n                movementType,\r\n                npcKey,\r\n                delay,\r\n                area,\r\n            } = npcData;\r\n\r\n            if (movementType === NPC_MOVEMENT_RANDOM) {\r\n                this.gridEngine.moveRandomly(npcKey, delay, area);\r\n            }\r\n        });\r\n\r\n        // enemies\r\n        enemiesData.forEach((enemyData) => {\r\n            const {\r\n                enemyAI,\r\n                enemyName,\r\n                speed,\r\n            } = enemyData;\r\n\r\n            this.gridEngine.moveRandomly(enemyName, 1000, 4);\r\n        });\r\n        this.physics.add.overlap(this.heroObjectCollider, this.enemiesSprites, (objA, objB) => {\r\n            const enemy = [objA, objB].find((obj) => obj !== this.heroObjectCollider);\r\n            if (enemy.isAttacking || this.gridEngine.isMoving(enemy.name)) {\r\n                return;\r\n            }\r\n\r\n            enemy.anims.play(`${enemy.enemySpecies}_attack`);\r\n            this.heroSprite.takeDamage(10);\r\n            enemy.isAttacking = true;\r\n            this.time.delayedCall(\r\n                this.getEnemyAttackSpeed(enemy.enemyType),\r\n                () => {\r\n                    enemy.isAttacking = false;\r\n                }\r\n            );\r\n        });\r\n\r\n        this.physics.add.overlap(this.heroPresenceCollider, this.enemiesSprites, (objA, objB) => {\r\n            const enemy = [objA, objB].find((obj) => obj !== this.heroPresenceCollider);\r\n\r\n            if (enemy.canSeeHero && enemy.enemyAI === ENEMY_AI_TYPE) {\r\n                enemy.isFollowingHero = true;\r\n                if (enemy.updateFollowHeroPosition) {\r\n                    const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n                    const heroPosition = this.gridEngine.getPosition('hero');\r\n                    const heroBackPosition = this.getBackPosition(facingDirection, heroPosition);\r\n\r\n                    if (\r\n                        enemy.lastKnowHeroPosition.x !== heroBackPosition.x\r\n                        || enemy.lastKnowHeroPosition.y !== heroBackPosition.y\r\n                    ) {\r\n                        const enemyPosition = this.gridEngine.getPosition(enemy.name);\r\n                        enemy.lastKnowHeroPosition = heroBackPosition;\r\n\r\n                        if (\r\n                            heroBackPosition.x === enemyPosition.x\r\n                            && heroBackPosition.y === enemyPosition.y\r\n                        ) {\r\n                            enemy.updateFollowHeroPosition = false;\r\n                            // TODO can attack I guess\r\n                            return;\r\n                        }\r\n\r\n                        enemy.updateFollowHeroPosition = false;\r\n                        this.time.delayedCall(1000, () => {\r\n                            enemy.updateFollowHeroPosition = true;\r\n                        });\r\n\r\n                        this.gridEngine.setSpeed(enemy.name, Math.ceil(enemy.speed * 1.5));\r\n                        this.gridEngine.moveTo(enemy.name, heroBackPosition, {\r\n                            NoPathFoundStrategy: 'CLOSEST_REACHABLE',\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            enemy.canSeeHero = enemy.body.embedded;\r\n        });\r\n\r\n        // Animations\r\n        this.gridEngine.movementStarted().subscribe(({ charId, direction }) => {\r\n            if (charId === 'hero') {\r\n                this.heroSprite.anims.play(`hero_walking_${direction}`);\r\n            } else {\r\n                const npc = npcSprites.getChildren().find((npcSprite) => npcSprite.texture.key === charId);\r\n                if (npc) {\r\n                    npc.anims.play(`${charId}_walking_${direction}`);\r\n                    return;\r\n                }\r\n\r\n                const enemy = this.enemiesSprites.getChildren().find((enemySprite) => enemySprite.name === charId);\r\n                if (enemy) {\r\n                    enemy.anims.play(`${enemy.enemySpecies}_walking`);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.gridEngine.movementStopped().subscribe(({ charId, direction }) => {\r\n            if (charId === 'hero') {\r\n                this.heroSprite.anims.stop();\r\n                this.heroSprite.setFrame(this.getStopFrame(direction, charId));\r\n            } else {\r\n                const npc = npcSprites.getChildren().find((npcSprite) => npcSprite.texture.key === charId);\r\n                if (npc) {\r\n                    npc.anims.stop();\r\n                    npc.setFrame(this.getStopFrame(direction, charId));\r\n                    return;\r\n                }\r\n\r\n                const enemy = this.enemiesSprites.getChildren().find((enemySprite) => enemySprite.name === charId);\r\n                if (enemy) {\r\n                    enemy.anims.play(`${enemy.enemySpecies}_idle`, true);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.gridEngine.directionChanged().subscribe(({ charId, direction }) => {\r\n            if (charId === 'hero') {\r\n                this.heroSprite.setFrame(this.getStopFrame(direction, charId));\r\n            } else {\r\n                const npc = npcSprites.getChildren().find((npcSprite) => npcSprite.texture.key === charId);\r\n                if (npc) {\r\n                    npc.setFrame(this.getStopFrame(direction, charId));\r\n                    return;\r\n                }\r\n\r\n                const enemy = this.enemiesSprites.getChildren().find((enemySprite) => enemySprite.name === charId);\r\n                if (enemy) {\r\n                    enemy.anims.play(`${enemy.enemySpecies}_idle`);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.heroActionCollider.update = () => {\r\n            const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n            this.heroPresenceCollider.setPosition(\r\n                this.heroSprite.x + 16,\r\n                this.heroSprite.y + 20\r\n            );\r\n\r\n            this.heroObjectCollider.setPosition(\r\n                this.heroSprite.x + 16,\r\n                this.heroSprite.y + 20\r\n            );\r\n\r\n            switch (facingDirection) {\r\n                case 'down': {\r\n                    this.heroActionCollider.setSize(14, 8);\r\n                    this.heroActionCollider.body.setSize(14, 8);\r\n                    this.heroActionCollider.setX(this.heroSprite.x + 9);\r\n                    this.heroActionCollider.setY(this.heroSprite.y + 36);\r\n\r\n                    break;\r\n                }\r\n\r\n                case 'up': {\r\n                    this.heroActionCollider.setSize(14, 8);\r\n                    this.heroActionCollider.body.setSize(14, 8);\r\n                    this.heroActionCollider.setX(this.heroSprite.x + 9);\r\n                    this.heroActionCollider.setY(this.heroSprite.y + 12);\r\n\r\n                    break;\r\n                }\r\n\r\n                case 'left': {\r\n                    this.heroActionCollider.setSize(8, 14);\r\n                    this.heroActionCollider.body.setSize(8, 14);\r\n                    this.heroActionCollider.setX(this.heroSprite.x);\r\n                    this.heroActionCollider.setY(this.heroSprite.y + 21);\r\n\r\n                    break;\r\n                }\r\n\r\n                case 'right': {\r\n                    this.heroActionCollider.setSize(8, 14);\r\n                    this.heroActionCollider.body.setSize(8, 14);\r\n                    this.heroActionCollider.setX(this.heroSprite.x + 24);\r\n                    this.heroActionCollider.setY(this.heroSprite.y + 21);\r\n\r\n                    break;\r\n                }\r\n\r\n                default: {\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.physics.add.overlap(this.heroActionCollider, npcSprites, (objA, objB) => {\r\n            if (this.isShowingDialog) {\r\n                return;\r\n            }\r\n\r\n            const npc = [objA, objB].find((obj) => obj !== this.heroActionCollider);\r\n\r\n            if (Input.Keyboard.JustDown(this.enterKey)) {\r\n                if (this.gridEngine.isMoving(npc.texture.key)) {\r\n                    return;\r\n                }\r\n\r\n                const characterName = npc.texture.key;\r\n                const customEvent = new CustomEvent('new-dialog', {\r\n                    detail: {\r\n                        characterName,\r\n                    },\r\n                });\r\n\r\n                window.dispatchEvent(customEvent);\r\n                const dialogBoxFinishedEventListener = () => {\r\n                    window.removeEventListener(`${characterName}-dialog-finished`, dialogBoxFinishedEventListener);\r\n                    this.gridEngine.moveRandomly(characterName);\r\n\r\n                    // just to consume the JustDown\r\n                    Input.Keyboard.JustDown(this.enterKey);\r\n                    Input.Keyboard.JustDown(this.spaceKey);\r\n\r\n                    this.time.delayedCall(100, () => {\r\n                        this.isShowingDialog = false;\r\n                        const { delay, area } = npcsKeys.find((npcData) => npcData.npcKey === characterName);\r\n                        this.gridEngine.moveRandomly(characterName, delay, area);\r\n                    });\r\n                };\r\n                window.addEventListener(`${characterName}-dialog-finished`, dialogBoxFinishedEventListener);\r\n\r\n                this.isShowingDialog = true;\r\n                const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n                this.gridEngine.stopMovement(characterName);\r\n                npc.setFrame(this.getStopFrame(this.getOppositeDirection(facingDirection), characterName));\r\n            }\r\n        });\r\n\r\n        this.physics.add.overlap(this.heroActionCollider, elementsLayers, (objA, objB) => {\r\n            const tile = [objA, objB].find((obj) => obj !== this.heroActionCollider);\r\n\r\n            // Handles attack\r\n            if (tile?.index > 0 && !tile.wasHandled) {\r\n                switch (tile.index) {\r\n                    case BUSH_INDEX: {\r\n                        if (this.isAttacking) {\r\n                            tile.wasHandled = true;\r\n\r\n                            this.time.delayedCall(\r\n                                ATTACK_DELAY_TIME,\r\n                                () => {\r\n                                    tile.setVisible(false);\r\n                                    this.spawnItem({\r\n                                        x: tile.pixelX,\r\n                                        y: tile.pixelY,\r\n                                    });\r\n                                    tile.destroy();\r\n                                }\r\n                            );\r\n                        }\r\n\r\n                        break;\r\n                    }\r\n\r\n                    case BOX_INDEX: {\r\n                        if (this.heroSprite.canPush && this.isAttacking) {\r\n                            const newPosition = this.calculatePushTilePosition();\r\n                            const canBePushed = map.layers.every((layer) => {\r\n                                const t = layer.tilemapLayer.getTileAtWorldXY(\r\n                                    newPosition.x,\r\n                                    newPosition.y\r\n                                );\r\n\r\n                                return !t?.properties?.ge_collide;\r\n                            });\r\n\r\n                            if (canBePushed && !tile.isMoved) {\r\n                                tile.isMoved = true;\r\n                                this.tweens.add({\r\n                                    targets: tile,\r\n                                    pixelX: newPosition.x,\r\n                                    pixelY: newPosition.y,\r\n                                    ease: 'Power2', // PhaserMath.Easing\r\n                                    duration: 700,\r\n                                    onComplete: () => {\r\n                                        tile.setVisible(false);\r\n                                        const newTile = tile.layer.tilemapLayer.putTileAt(\r\n                                            BOX_INDEX,\r\n                                            newPosition.x / 16,\r\n                                            newPosition.y / 16,\r\n                                            true\r\n                                        );\r\n\r\n                                        newTile.properties = {\r\n                                            ...tile.properties,\r\n                                        };\r\n                                        newTile.isMoved = true;\r\n                                        tile.destroy();\r\n                                    },\r\n                                });\r\n                            }\r\n                        }\r\n\r\n                        break;\r\n                    }\r\n\r\n                    default: {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        this.physics.add.overlap(this.heroActionCollider, this.enemiesSprites, (objA, objB) => {\r\n            const enemy = [objA, objB].find((obj) => obj !== this.heroActionCollider);\r\n\r\n            // Handles attack\r\n            if (this.isAttacking) {\r\n                const isSpaceJustDown = this.isSpaceJustDown;\r\n                this.time.delayedCall(\r\n                    ATTACK_DELAY_TIME,\r\n                    () => {\r\n                        enemy.takeDamage(25, isSpaceJustDown);\r\n                    }\r\n                );\r\n            }\r\n        });\r\n    }\r\n\r\n    update() {\r\n        this.isSpaceJustDown = Input.Keyboard.JustDown(this.spaceKey);\r\n\r\n        if (\r\n            this.isTeleporting\r\n            || this.isAttacking\r\n            || this.isShowingDialog\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        if (\r\n            !this.gridEngine.isMoving('hero')\r\n            && this.isSpaceJustDown\r\n            && this.heroSprite.haveSword\r\n        ) {\r\n            const facingDirection = this.gridEngine.getFacingDirection('hero');\r\n            this.heroSprite.anims.play(`hero_attack_${facingDirection}`);\r\n            this.isAttacking = true;\r\n            return;\r\n        }\r\n\r\n        this.enemiesSprites.getChildren().forEach((enemy) => {\r\n            enemy.canSeeHero = enemy.body.embedded;\r\n            if (!enemy.canSeeHero && enemy.isFollowingHero) {\r\n                enemy.isFollowingHero = false;\r\n                this.gridEngine.setSpeed(enemy.name, enemy.speed);\r\n                this.gridEngine.moveRandomly(enemy.name, 1000, 4);\r\n            }\r\n        });\r\n\r\n        this.heroActionCollider.update();\r\n        if (this.cursors.left.isDown || this.wasd.left.isDown) {\r\n            this.gridEngine.move('hero', 'left');\r\n        } else if (this.cursors.right.isDown || this.wasd.right.isDown) {\r\n            this.gridEngine.move('hero', 'right');\r\n        } else if (this.cursors.up.isDown || this.wasd.up.isDown) {\r\n            this.gridEngine.move('hero', 'up');\r\n        } else if (this.cursors.down.isDown || this.wasd.down.isDown) {\r\n            this.gridEngine.move('hero', 'down');\r\n        }\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/dialog_borderbox.c5432d54.png\";","import { useEffect, useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport classNames from 'classnames';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    menuWrapper: ({ multiplier }) => ({\r\n        fontFamily: '\"Press Start 2P\"',\r\n        fontSize: `${10 * multiplier}px`,\r\n        textTransform: 'uppercase',\r\n        position: 'absolute',\r\n        transform: 'translate(-50%, 0%)',\r\n    }),\r\n    menuPositionWrapper: ({ multiplier, position, width, height }) => {\r\n        const left = window.innerWidth - (width * multiplier);\r\n        const menuWidth = 160 * multiplier;\r\n        if (position === 'center') {\r\n            return {\r\n                minWidth: `${menuWidth}px`,\r\n                left: '50%',\r\n                top: `${(height * multiplier) / 2}px`,\r\n            };\r\n        }\r\n\r\n        if (position === 'left') {\r\n            return {\r\n                minWidth: `${menuWidth}px`,\r\n                left: `${(95 * multiplier) + left / 2}px`,\r\n                top: `${50 * multiplier}px`,\r\n            };\r\n        }\r\n\r\n        return {};\r\n    },\r\n    menuItemsWrapper: {\r\n        textAlign: 'center',\r\n        padding: 0,\r\n    },\r\n    menuItem: ({ multiplier }) => ({\r\n        cursor: 'pointer',\r\n        listStyle: 'none',\r\n        padding: `${5 * multiplier}px`,\r\n        marginBottom: `${5 * multiplier}px`,\r\n        backgroundColor: '#94785c',\r\n        border: `${multiplier}px solid #79584f`,\r\n    }),\r\n    selectedMenuItem: ({ multiplier }) => ({\r\n        fontSize: `${11 * multiplier}px`,\r\n        border: `${multiplier}px solid #ddd`,\r\n    }),\r\n}));\r\n\r\nconst GameMenu = ({\r\n    items,\r\n    position = 'center',\r\n    gameSize,\r\n    onSelected,\r\n}) => {\r\n    const {\r\n        width,\r\n        height,\r\n        multiplier,\r\n    } = gameSize;\r\n\r\n    const classes = useStyles({\r\n        width,\r\n        height,\r\n        multiplier,\r\n        position,\r\n    });\r\n\r\n    const [selectedItemIndex, setSelectedItemIndex] = useState(0);\r\n\r\n    useEffect(() => {\r\n        const handleKeyPressed = (e) => {\r\n            switch (e.code) {\r\n                case 'Enter': {\r\n                    onSelected(items[selectedItemIndex]);\r\n                    break;\r\n                }\r\n\r\n                case 'ArrowUp': {\r\n                    if (selectedItemIndex > 0) {\r\n                        setSelectedItemIndex(\r\n                            selectedItemIndex - 1\r\n                        );\r\n                    }\r\n\r\n                    break;\r\n                }\r\n\r\n                case 'ArrowDown': {\r\n                    if (items.length - 1 > selectedItemIndex) {\r\n                        setSelectedItemIndex(\r\n                            selectedItemIndex + 1\r\n                        );\r\n                    }\r\n\r\n                    break;\r\n                }\r\n\r\n                default: {\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n        window.addEventListener('keydown', handleKeyPressed);\r\n\r\n        return () => window.removeEventListener('keydown', handleKeyPressed);\r\n    }, [items, onSelected, selectedItemIndex]);\r\n\r\n    return (\r\n        <div className={classNames(classes.menuWrapper, classes.menuPositionWrapper)}>\r\n            <ul className={classes.menuItemsWrapper}>\r\n                {items.map((item, index) => (\r\n                    <li\r\n                        key={index}\r\n                        className={classNames(classes.menuItem, {\r\n                            [classes.selectedMenuItem]: selectedItemIndex === index,\r\n                        })}\r\n                        onMouseEnter={() => {\r\n                            setSelectedItemIndex(index);\r\n                        }}\r\n                        onClick={() => {\r\n                            onSelected(items[selectedItemIndex]);\r\n                        }}\r\n                    >\r\n                        {item}\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default GameMenu;\r\n","import { useMemo } from 'react';\r\nimport { animated, useTransition } from 'react-spring';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    dialogMessage: ({ multiplier }) => ({\r\n        fontFamily: '\"Press Start 2P\"',\r\n        fontSize: `${6 * multiplier}px`,\r\n        textTransform: 'uppercase',\r\n    }),\r\n}));\r\n\r\nconst Message = ({\r\n    message = [],\r\n    trail = 35,\r\n    multiplier = 1,\r\n    onMessageEnded = () => {},\r\n    forceShowFullMessage = false,\r\n}) => {\r\n    const classes = useStyles({ multiplier });\r\n    const items = useMemo(\r\n        () => message.trim().split('').map((letter, index) => ({\r\n            item: letter,\r\n            key: index,\r\n        })),\r\n        [message]\r\n    );\r\n\r\n    const transitions = useTransition(items, {\r\n        trail,\r\n        from: { display: 'none' },\r\n        enter: { display: '' },\r\n        onRest: (status, controller, item) => {\r\n            if (item.key === items.length - 1) {\r\n                onMessageEnded();\r\n            }\r\n        },\r\n    });\r\n\r\n    return (\r\n        <div className={classes.dialogMessage}>\r\n            {forceShowFullMessage && (\r\n                <span>{message}</span>\r\n            )}\r\n\r\n            {!forceShowFullMessage && transitions((styles, { item, key }) => (\r\n                <animated.span key={key} style={styles}>\r\n                    {item}\r\n                </animated.span>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Message;\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\n// Images\r\nimport dialogBorderBox from './assets/images/dialog_borderbox.png';\r\n\r\n// Components\r\nimport Message from './Message';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    dialogWindow: ({ width, height, multiplier }) => {\r\n        const messageBoxHeight = Math.ceil((height / 3.5) * multiplier);\r\n        return {\r\n            imageRendering: 'pixelated',\r\n            fontFamily: '\"Press Start 2P\"',\r\n            textTransform: 'uppercase',\r\n            backgroundColor: '#e2b27e',\r\n            border: 'solid',\r\n            borderImage: `url(\"${dialogBorderBox}\") 6 / ${6 * multiplier}px ${6 * multiplier}px ${6 * multiplier}px ${6 * multiplier}px stretch`,\r\n            padding: `${8 * multiplier}px`,\r\n            position: 'absolute',\r\n            top: `${Math.ceil((height * multiplier) - (messageBoxHeight + messageBoxHeight * 0.1))}px`,\r\n            width: `${Math.ceil(width * 0.8 * multiplier)}px`,\r\n            left: '50%',\r\n            transform: 'translate(-50%, 0%)',\r\n            minHeight: `${messageBoxHeight}px`,\r\n        };\r\n    },\r\n    dialogTitle: ({ multiplier }) => ({\r\n        fontSize: `${8 * multiplier}px`,\r\n        marginBottom: `${6 * multiplier}px`,\r\n        fontWeight: 'bold',\r\n    }),\r\n    dialogFooter: ({ multiplier }) => ({\r\n        fontSize: `${8 * multiplier}px`,\r\n        cursor: 'pointer',\r\n        textAlign: 'end',\r\n        position: 'absolute',\r\n        right: `${6 * multiplier}px`,\r\n        bottom: `${6 * multiplier}px`,\r\n    }),\r\n}));\r\n\r\nconst DialogBox = ({\r\n    messages,\r\n    characterName,\r\n    onDone,\r\n    gameSize,\r\n}) => {\r\n    const {\r\n        width,\r\n        height,\r\n        multiplier,\r\n    } = gameSize;\r\n\r\n    const [currentMessage, setCurrentMessage] = useState(0);\r\n    const [messageEnded, setMessageEnded] = useState(false);\r\n    const [forceShowFullMessage, setForceShowFullMessage] = useState(false);\r\n    const classes = useStyles({\r\n        width,\r\n        height,\r\n        multiplier,\r\n    });\r\n\r\n    const handleClick = useCallback(() => {\r\n        if (messageEnded) {\r\n            setMessageEnded(false);\r\n            setForceShowFullMessage(false);\r\n            if (currentMessage < messages.length - 1) {\r\n                setCurrentMessage(currentMessage + 1);\r\n            } else {\r\n                setCurrentMessage(0);\r\n                onDone();\r\n            }\r\n        } else {\r\n            setMessageEnded(true);\r\n            setForceShowFullMessage(true);\r\n        }\r\n    }, [currentMessage, messageEnded, messages.length, onDone]);\r\n\r\n    useEffect(() => {\r\n        const handleKeyPressed = (e) => {\r\n            if (['Enter', 'Space', 'Escape'].includes(e.code)) {\r\n                handleClick();\r\n            }\r\n        };\r\n        window.addEventListener('keydown', handleKeyPressed);\r\n\r\n        return () => window.removeEventListener('keydown', handleKeyPressed);\r\n    }, [handleClick]);\r\n\r\n    return (\r\n        <div className={classes.dialogWindow}>\r\n            <div className={classes.dialogTitle}>\r\n                {characterName}\r\n            </div>\r\n            <Message\r\n                action={messages[currentMessage].action}\r\n                message={messages[currentMessage].message}\r\n                key={currentMessage}\r\n                multiplier={multiplier}\r\n                forceShowFullMessage={forceShowFullMessage}\r\n                onMessageEnded={() => {\r\n                    setMessageEnded(true);\r\n                }}\r\n            />\r\n            <div\r\n                onClick={handleClick}\r\n                className={classes.dialogFooter}\r\n            >\r\n                {(currentMessage === messages.length - 1 && messageEnded) ? 'Ok' : 'Next'}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DialogBox;\r\n","export default __webpack_public_path__ + \"static/media/coin.cae0d64b.png\";","import { makeStyles } from '@material-ui/core/styles';\r\nimport classNames from 'classnames';\r\n\r\n// Images\r\nimport coinImage from './assets/images/coin.png';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    coinContainer: ({ multiplier, width }) => {\r\n        const left = window.innerWidth - (width * multiplier);\r\n        return {\r\n            fontFamily: '\"Press Start 2P\"',\r\n            fontSize: `${12 * multiplier}px`,\r\n            textTransform: 'uppercase',\r\n            imageRendering: 'pixelated',\r\n            position: 'absolute',\r\n            top: `${32 * multiplier}px`,\r\n            left: `${(16 * multiplier) + left / 2}px`,\r\n            display: 'flex',\r\n            cursor: 'default',\r\n            userSelect: 'none',\r\n        };\r\n    },\r\n    coin: ({ multiplier, width }) => ({\r\n        backgroundSize: `${16 * multiplier}px ${16 * multiplier}px`,\r\n        background: `url(\"${coinImage}\") no-repeat 0 0`,\r\n        width: `${16 * multiplier}px`,\r\n        height: `${16 * multiplier}px`,\r\n    }),\r\n    coinFull: ({ multiplier }) => {\r\n        const strokeSize = multiplier;\r\n        return {\r\n            fontSize: `${11 * multiplier}px`,\r\n            textShadow: `-${strokeSize}px 0 #FFFFFF, 0 ${strokeSize}px #FFFFFF, ${strokeSize}px 0 #FFFFFF, 0 -${strokeSize}px #FFFFFF`,\r\n            color: '#119923',\r\n        };\r\n    },\r\n}));\r\n\r\nconst HeroCoin = ({\r\n    gameSize,\r\n    heroCoins,\r\n}) => {\r\n    const {\r\n        width,\r\n        height,\r\n        multiplier,\r\n    } = gameSize;\r\n\r\n    const classes = useStyles({\r\n        width,\r\n        height,\r\n        multiplier,\r\n    });\r\n\r\n    return (\r\n        <div className={classes.coinContainer}>\r\n            <div className={classes.coin} />\r\n            <span\r\n                className={classNames({\r\n                    [classes.coinFull]: heroCoins >= 999,\r\n                })}\r\n            >\r\n                {heroCoins.toString().padStart(3, '0')}\r\n            </span>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default HeroCoin;\r\n","export default __webpack_public_path__ + \"static/media/health.b178a75b.png\";","import { makeStyles } from '@material-ui/core/styles';\r\nimport classNames from 'classnames';\r\n\r\n// Images\r\nimport healthImage from './assets/images/health.png';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    healthContainer: ({ multiplier, width }) => {\r\n        const left = window.innerWidth - (width * multiplier);\r\n        return {\r\n            imageRendering: 'pixelated',\r\n            position: 'absolute',\r\n            top: `${16 * multiplier}px`,\r\n            left: `${(16 * multiplier) + left / 2}px`,\r\n            display: 'flex',\r\n        };\r\n    },\r\n    health: ({ multiplier, width }) => ({\r\n        width: `${16 * multiplier}px`,\r\n        height: `${16 * multiplier}px`,\r\n    }),\r\n    healthStateFull: ({ multiplier }) => ({\r\n        backgroundSize: `${48 * multiplier}px ${16 * multiplier}px`,\r\n        background: `url(\"${healthImage}\") no-repeat 0 0`,\r\n    }),\r\n    healthStateHalf: ({ multiplier }) => ({\r\n        backgroundSize: `${48 * multiplier}px ${16 * multiplier}px`,\r\n        background: `url(\"${healthImage}\") no-repeat -${16 * multiplier}px 0`,\r\n    }),\r\n    healthStateEmpty: ({ multiplier }) => ({\r\n        backgroundSize: `${48 * multiplier}px ${16 * multiplier}px`,\r\n        background: `url(\"${healthImage}\") no-repeat -${32 * multiplier}px 0`,\r\n    }),\r\n}));\r\n\r\nconst HeroHealth = ({\r\n    gameSize,\r\n    healthStates,\r\n}) => {\r\n    const {\r\n        width,\r\n        height,\r\n        multiplier,\r\n    } = gameSize;\r\n\r\n    const classes = useStyles({\r\n        width,\r\n        height,\r\n        multiplier,\r\n    });\r\n\r\n    return (\r\n        <div className={classes.healthContainer}>\r\n            {healthStates.map((healthState, index) => (\r\n                <div\r\n                    key={index}\r\n                    className={classNames(classes.health, {\r\n                        [classes.healthStateFull]: healthState === 'full',\r\n                        [classes.healthStateHalf]: healthState === 'half',\r\n                        [classes.healthStateEmpty]: healthState === 'empty',\r\n                    })}\r\n                />\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default HeroHealth;\r\n","import {useCallback, useEffect, useState} from 'react';\r\nimport Phaser from 'phaser';\r\nimport GridEngine from 'grid-engine';\r\nimport BootScene from './game/scenes/BootScene';\r\nimport MainMenuScene from './game/scenes/MainMenuScene';\r\nimport GameOverScene from './game/scenes/GameOverScene';\r\nimport GameScene from './game/scenes/GameScene';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport dialogBorderBox from './game/assets/images/dialog_borderbox.png';\r\nimport GameMenu from \"./game/GameMenu\";\r\nimport DialogBox from \"./game/DialogBox\";\r\nimport HeroCoin from \"./game/HeroCoin\";\r\nimport HeroHealth from \"./game/HeroHealth\";\r\nimport './App.css';\r\nimport {calculateGameSize} from \"./game/utils\";\r\n\r\nconst { width, height, multiplier } = calculateGameSize();\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  modal: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  paper: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    border: '2px solid #000',\r\n    boxShadow: theme.shadows[5],\r\n    padding: theme.spacing(2, 4, 3),\r\n    overflow: 'auto',\r\n  },\r\n  postContainer: {\r\n    maxWidth: '90%',\r\n    maxHeight: '90%',\r\n  },\r\n  gameContentWrapper: {\r\n    width: `${width * multiplier}px`,\r\n    height: `${height * multiplier}px`,\r\n    margin: 'auto',\r\n    padding: 0,\r\n    overflow: 'hidden',\r\n    '& canvas': {\r\n      imageRendering: 'pixelated',\r\n      '-ms-interpolation-mode': 'nearest-neighbor',\r\n      boxShadow: '0px 0px 0px 3px rgba(0,0,0,0.75)',\r\n    },\r\n  },\r\n  pageWrapper: {\r\n    background: theme.palette.background.paper,\r\n    padding: 0,\r\n    margin: 0,\r\n  },\r\n  loadingText: {\r\n    fontFamily: '\"Press Start 2P\"',\r\n    marginTop: '30px',\r\n    marginLeft: '30px',\r\n  },\r\n  preLoadDialogImage: {\r\n    backgroundImage: `url(\"${dialogBorderBox}\")`,\r\n    backgroundSize: '1px',\r\n    backgroundRepeat: 'no-repeat',\r\n  },\r\n  gameWrapper: {\r\n    color: '#FFFFFF',\r\n  },\r\n  gameGif: {\r\n    width: '100%',\r\n    position: 'absolute',\r\n    imageRendering: 'pixelated',\r\n    top: 0,\r\n  },\r\n}));\r\n\r\nconst dialogs = {\r\n  \"npc_01\": [{\r\n    \"message\": \"Hello\",\r\n  }, {\r\n    \"message\": \"How are you?\",\r\n  }],\r\n  \"npc_02\": [{\r\n    \"message\": \"Hello there\",\r\n  }],\r\n  \"npc_03\": [{\r\n    \"message\": \"Hi\",\r\n  }, {\r\n    \"message\": \"Ok bye!\",\r\n  }],\r\n  \"npc_04\": [{\r\n    \"message\": \"Hey\",\r\n  }],\r\n  \"sword\": [{\r\n    \"message\": \"You got a sword\",\r\n  }],\r\n  \"push\": [{\r\n    \"message\": \"You can push boxes now\",\r\n  }],\r\n  \"sign_01\": [{\r\n    \"message\": \"You can read this!\",\r\n  }],\r\n  \"book_01\": [{\r\n    \"message\": \"Welcome to the game!\",\r\n  }]\r\n};\r\n\r\nfunction App() {\r\n  const classes = useStyles();\r\n  const [messages, setMessages] = useState([]);\r\n  const [characterName, setCharacterName] = useState('');\r\n  const [gameMenuItems, setGameMenuItems] = useState([]);\r\n  const [gameMenuPosition, setGameMenuPosition] = useState('center');\r\n  const [heroHealthStates, setHeroHealthStates] = useState([]);\r\n  const [heroCoins, setHeroCoins] = useState(null);\r\n\r\n  const handleMessageIsDone = useCallback(() => {\r\n    const customEvent = new CustomEvent(`${characterName}-dialog-finished`, {\r\n      detail: {},\r\n    });\r\n    window.dispatchEvent(customEvent);\r\n\r\n    setMessages([]);\r\n    setCharacterName('');\r\n  }, [characterName]);\r\n\r\n  const handleMenuItemSelected = useCallback((selectedItem) => {\r\n    setGameMenuItems([]);\r\n\r\n    const customEvent = new CustomEvent('menu-item-selected', {\r\n      detail: {\r\n        selectedItem,\r\n      },\r\n    });\r\n    window.dispatchEvent(customEvent);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const game = new Phaser.Game({\r\n      type: Phaser.AUTO,\r\n      title: 'some-game-title',\r\n      parent: 'game-content',\r\n      orientation: Phaser.Scale.LANDSCAPE,\r\n      localStorageName: 'some-game-title',\r\n      width,\r\n      height,\r\n      autoRound: true,\r\n      pixelArt: true,\r\n      scale: {\r\n        autoCenter: Phaser.Scale.CENTER_BOTH,\r\n        mode: Phaser.Scale.ENVELOP,\r\n      },\r\n      scene: [\r\n        BootScene,\r\n        MainMenuScene,\r\n        GameScene,\r\n        GameOverScene,\r\n      ],\r\n      physics: {\r\n        default: 'arcade',\r\n      },\r\n      plugins: {\r\n        scene: [\r\n          {\r\n            key: 'gridEngine',\r\n            plugin: GridEngine,\r\n            mapping: 'gridEngine',\r\n          },\r\n        ],\r\n      },\r\n      backgroundColor: '#000000',\r\n    });\r\n\r\n    window.phaserGame = game;\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const dialogBoxEventListener = ({ detail }) => {\r\n      // TODO fallback\r\n      setCharacterName(detail.characterName);\r\n      setMessages(\r\n          dialogs[detail.characterName]\r\n      );\r\n    };\r\n    window.addEventListener('new-dialog', dialogBoxEventListener);\r\n\r\n    const gameMenuEventListener = ({ detail }) => {\r\n      setGameMenuItems(detail.menuItems);\r\n      setGameMenuPosition(detail.menuPosition);\r\n    };\r\n    window.addEventListener('menu-items', gameMenuEventListener);\r\n\r\n    const heroHealthEventListener = ({ detail }) => {\r\n      setHeroHealthStates(detail.healthStates);\r\n    };\r\n    window.addEventListener('hero-health', heroHealthEventListener);\r\n\r\n    const heroCoinEventListener = ({ detail }) => {\r\n      setHeroCoins(detail.heroCoins);\r\n    };\r\n    window.addEventListener('hero-coin', heroCoinEventListener);\r\n\r\n    return () => {\r\n      window.removeEventListener('new-dialog', dialogBoxEventListener);\r\n      window.removeEventListener('menu-items', gameMenuEventListener);\r\n      window.removeEventListener('hero-health', heroHealthEventListener);\r\n      window.removeEventListener('hero-coin', heroCoinEventListener);\r\n    };\r\n  }, [setCharacterName, setMessages]);\r\n\r\n  return (\r\n      <div>\r\n        <div className={classes.gameWrapper}>\r\n          <div\r\n              id=\"game-content\"\r\n              className={classes.gameContentWrapper}\r\n          >\r\n            {/* this is where the game canvas will be rendered */}\r\n          </div>\r\n          {heroHealthStates.length > 0 && (\r\n              <HeroHealth\r\n                  gameSize={{\r\n                    width,\r\n                    height,\r\n                    multiplier,\r\n                  }}\r\n                  healthStates={heroHealthStates}\r\n              />\r\n          )}\r\n          {heroCoins !== null && (\r\n              <HeroCoin\r\n                  gameSize={{\r\n                    width,\r\n                    height,\r\n                    multiplier,\r\n                  }}\r\n                  heroCoins={heroCoins}\r\n              />\r\n          )}\r\n          {messages.length > 0 && (\r\n              <DialogBox\r\n                  onDone={handleMessageIsDone}\r\n                  characterName={characterName}\r\n                  messages={messages}\r\n                  gameSize={{\r\n                    width,\r\n                    height,\r\n                    multiplier,\r\n                  }}\r\n              />\r\n          )}\r\n          {gameMenuItems.length > 0 && (\r\n              <GameMenu\r\n                  items={gameMenuItems}\r\n                  gameSize={{\r\n                    width,\r\n                    height,\r\n                    multiplier,\r\n                  }}\r\n                  position={gameMenuPosition}\r\n                  onSelected={handleMenuItemSelected}\r\n              />\r\n          )}\r\n        </div>\r\n      </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}